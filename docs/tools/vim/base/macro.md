---
sidebarDepth: 2
---

## 寄存器

### 概念

+ CPU 寄存器用于暂存指令，而 vim 寄存器概念与之类似，但用来暂存文本
+ vim 寄存器暂存的文本还可以是一个宏命令，使用 `@a` 的方式回放(replay)一个宏命令
+ 使用 `"a` 的方式来引用寄存器，如 `"ap` 将会粘贴寄存器 a 的内容
+ 使用 `:reg` 查看现有寄存器，以及它们目前存储的内容(或查看指定寄存器：`:reg a b`)


### 分类

+ 默认寄存器(`"`)：被 `d`/`c`/`s`/`x`/`y` 操作的内容会被存放在该寄存器中，使用 `p` 粘贴时也是引用该寄存器的内容(`p` 等同于 `""p`)
+ 字母寄存器(`a`~`z`)：26 个可供使用的寄存器，除非你手动使用，否则 vim 不会自动使用
+ 数字寄存器(`0`~`9`)：vim 会自动使用，其中 `0` 保存 yank 的最新内容，而 `1`~`9` 保存历史 yank 的内容
+ 复制专用寄存器(`0`)：`0` 寄存器只会保存 yank 的最新内容
+ 只读寄存器：只能读取不能写入
  + `.`：保存最后插入的文本
  + `%`：保存当前文件的完整路径，常用来将路径放到系统剪切板(`:let @+=@%`)
  + `:`：保存最近执行的命令，可通过 `@:` 回放
  + `#`：轮换文件名，不常用
+ 表达式寄存器(`=`)：
+ 搜索寄存器(`/`)：保存最近搜索过的内容
+ 黑洞寄存器(`_`)：放入该寄存器的内容都会被吞噬，当不想污染 yank 寄存器的时候可以这样使用(如之前复制了内容，现在要先删除一些内容再粘贴之前的内容，可以使用 `"_daw` 的方式)
+ 系统剪切板(`+`)：当要与操作系统剪切板交互时，就要使用该寄存器



### let 命令

+ let 命令用来修改寄存器的内容：
```sh
# a 寄存器保存了一个宏命令：在文件首部添加一行，插入 123
:let @a="ggO123"
```
+ 使用大写的寄存器名，将会是附加而不是全部替换：
```sh
:let @a="ggO123"
:let @A="i;"     # 附加一个 ; 结尾
```




## 宏录制

+ 宏录制相当于把一系列的操作录制到寄存器，然后再回放(replay)：
```
qa：开始录制，保存至 a 寄存器
q：结束录制
@a：回放 a 寄存器的操作
@@：回放最近一个录制的操作
```

+ 展示：
```
准备：新建一个文本，其只有一行，且只有一个数字 1
完整命令：qaYp<C-a>q
+ qa：开始录制，存至寄存器 a
+ Yp：复制一行(这里复制了 1)
+ <C-a>：增加 1
+ q：结束录制

@a：在 1 下面写 2
@@：在 2 下面写 3
100@@：继续写至 103
```