---
sidebarDepth: 2
---

## 修改权限

### chgrp

+ change group，修改文件所属用户组
```sh
chgrp <用户名> [-R] <目录｜文件>

# -R：递归修改子目录下的所有文件和目录
```

### chown

+ change owner，修改文件拥有者
```sh
chown [-R] <用户名> <文件｜目录>
chown [-R] <用户名>:<用户组名> <文件｜目录>

# -R：递归修改子目录下的文件和目录
# : 也可以使用 . 代替，当只修改用户组时，可以：
chown .sshd initial-setup-ks.cfg
```

### chmod

+ 修改权限、SUID、SGID、SBIT 等
```sh
# 方式1：使用三位数值设置权限
chmod [-R] <三位数值权限> <文件｜目录>
chmod 755 hello.txt   # 权限为 -rwxr-xr-x

# 方式2：使用符号设置权限，注意不能有空格，a 表示所有人
chmod [u=<符号权限>,g=<符号权限>,o=<符号权限>,a=<符号权限>] <文件｜目录>
chmod u=rwx,g=rx,o=rx hello.txt   # 权限为 -rwxr-xr-x

# 方式3：使用符号添加或删除权限，当不知道原有权限时这很有用
chmod [u<+|-><符号权限>,g<+|-><符号权限>,o<+|-><符号权限>,a<+|-><符号权限>] <文件｜目录>
chmod a+w .bashrc   # 为所有人添加写权限
chmod a-x .bashrc   # 拿掉所有人的执行权限
```

### umask

+ 显示/设置文件默认权限
```sh
umask       # 0022
umask -S    # u=rwx,g=rx,o=rx
umask 002   # 设置为 0002
```



## 处理目录

### cd

+ 改变当前的工作目录，与 `Windows` 下的 `cd` 命令一致
```sh
cd /    # 切换根目录
cd ..   # 返回上级目录
cd -    # 返回刚刚的目录
cd ~    # 切换工作目录，即 /root
cd ~seven   # 切换指定用户的工作目录
cd ~/.ssh   # 切换指定目录，相对于 ～
cd ../../path/to/cd   # 切换指定目录，相对路径
cd /path/to/cd        # 切换指定目录，绝对路径
```

### pwd

+ 显示当前所在目录
```sh
pwd [-P]

# -P：显示真正的路径，而非使用链接(link)路径
```

### mkdir

+ 创建目录
```sh
mkdir [-mp] <目录名>

# -m：设置目录的权限，不使用默认权限(umask)
# -p：识别深层目录，递归创建
```

### rmdir

+ 删除空目录(目录内不能有任何文件或子目录)
```sh
rmdir [-p] <目录名>

# -p：同时删除上层的空目录
```



## 文件与目录管理

### ls

+ 显示指定工作目录下的内容，类似 `Windows` 下的 `dir` 命令，而且 `Linux` 中也能使用 `dir` 代替 `ls`
```sh
ls [-aAdfFhilnrRSt] <文件名或目录名>
ls [--color={never,auto,always}] <文件名或目录名>
ls [--full-time] <文件名或目录名>

# -a：显示所有文件和子目录，包含隐藏文件(.开头的文件或目录)
# -A：与 -a 类似，但不显示 . 和 .. 两个目录
# -d：显示目录列表
# -l：显示文件名称、权限、使用者、大小等信息
# -h：自动转化容量单位
# -r：将排序结果反向输出
# -t：以时间排序
# -S：以文件大小排序
# -u：以文件上次被访问的时间排序
# -x：按列输出，横向排序
# -C：按列输出，纵向排序
# -m：横向输出，以 `,` 分隔
# -q：用 `?` 代替不可输出的字符
# -k：以 k 字节的形式表示文件的大小
# -o：显示除组信息外的详细信息
# -R：列出所有子目录下的文件
# -Q：把输出的文件名用括号包含
# -pF：添加文件类型(`*`为可执行的普通文件，`/`为目录，`@`为符号连接，`\|`为 FIFO，`=`为套接字)
# --color：接 设置不显示颜色、显示颜色、自动判断
# --full-time：输出完整时间
# --time={atime,ctime}：输出 ctime 或 atime，而不是修改时间

ls -al      # 显示当前目录的所有文件、目录的详细信息
ls -apF     # 显示当前目录下的所有文件，并标明文件类型
ls -l /home # 显示指定目录的文件、目录信息
```

### cp

+ 复制文件或目录，要注意权限，默认情况下复制后目标文件的拥有者是命令操作者本身
```sh
cp [-adfilprsu] <源> <目标>
cp [-adfilprsu] source1, source2, ... <目标目录>  # 多个源文件时目标一定要是目录

# -a：相当于 -dr --preserve=all(常用)
# -d：对链接文件只复制链接文件属性，而非复制文件本身
# -l：进行硬链接的链接文件建立，而非复制文件本身
# -r：若源文件是目录，则递归复制(常用)
# -i：遇到同名文件时提示是否覆盖(常用)
# -f：强制覆盖
# -p：保留文件的权限、用户、时间(备份常用)
# -s：复制为符号链接文件，即 “快捷方式”
# -u：目标文件比源文件旧、或目标文件不存在时才复制
# --preserve=all：除 -p 参数外，还加入 SELinux 的属性、links、xattr 等
```

### rm

+ 删除目录或文件
```sh
rm [-fir] <文件｜目录>

# -i：交互式删除，在删除前确认
# -r：递归删除子目录和文件
# -f：强制删除，不提示确认

rm a.txt  # 删除文件
rm -r b   # 删除目录，必须带 -r
rm -rf b  # 对信任的操作使用 -f

# 不建议使用 - 开头的文件名，但对于以 - 开头的文件删除，可以有两种变通：
rm ./-a.txt
rm -- -a.txt
```

### mv

+ 用于文件/目录更名或移动到指定目录
```sh
mv [-fiu] <源> <目标>
mv [-fiu] source1, source2, ... <目标目录>  # 多个源文件时，目标一定是目录

# -i：启用交互式操作
# -r：不提示移动，默认覆盖

mv a.txt b.txt  # 重命名文件
mv abc cba      # 重命名文件夹
mv a.txt /b     # 移动文件
mv a b          # 移动文件夹
```

### touch

+ 用于修改文件时间或创建新文件
```sh
touch [-acdmtr] <文件名>

# -a：修改文件的访问时间(atime)为系统当前时间
# -m：修改文件的修改时间(mtime)为系统当前时间
# -c：修改文件的状态时间(ctime)为系统当前时间，若文件不存在则不创建也不提示
# -d：接 自定义的日期，相当于 --date="自定义的日期"
# -t：接 自定义的时间，格式为 YYYYMMDDhhmm
# -r：接 参考文件/目录，将设置为该参考文件/目录的日期、时间

# 主要用来创建空文件：
touch hello.txt

# 将日期设置为两天前
touch -d "2 days age" hello.txt
```

::: tip 文件的三个时间：
+ 修改时间(modification, **mtime**)：当文件的内容变更时，会更新该时间
+ 读取时间(access time, **atime**)：当文件的内容被读取(如 cat 命令)时，会更新该时间
+ 状态时间(status time, **ctime**)：当文件的状态(权限或属性)变更时，会更新该时间
:::


### file

+ 查看文件的基本信息，能够显示文件的类型、格式、是否使用动态链接库等
```sh
file [-bLzi] <文件名>

# -b：显示文件类型结果，不显示对应文件名称
# -L：直接显示符号链接所指向文件的类型
# -z：显示压缩文件的信息
# -i：如果文件不是常规文件，则不进一步对文件类型进行分类
```



## 查看文件内容

+ 这些命令大都支持管道功能，可以组合它们实现复杂的功能

### cat

+ concatenate，将文件的内容输出到屏幕
```sh
cat [-AbEnTv] <文件名>

# -b：列出行号，但空白行不赋予行号
# -n：列出行号，空白行也有行号
# -v：列出看不出来的特殊字符(写成转义字符)
# -T：将 Tab 按键用 ^I 显示
# -E：将结尾换行符用 $ 显示
# -A：相当于 -vET

cat hello.txt   # 输出文件内容到屏幕
cat a.txt b.txt > c.txt   # 合并文件内容到另一个文件
```

### tac 

+ 类似 `cat`，但从文件尾部开始输出(倒序)

### nl

+ 加行号打印
```sh
nl [-bnw] <文件名>

# -b：接 行号的方式，a(始终列出行号)、b(空行不列出行号)
# -n：接 行号的显示的位置，ln(屏幕左侧)、rn(自己栏位的最右方，不加 0)、rz(自己栏位的最右方，加 0)
# -w：接 行号栏位占用的字符数，默认 6
```

### more

+ 分屏显示文件内容，显示完时会自动退出，也可手动使用 q 按键退出
```sh
more [-dspc] <文件名>

# -d：在底部显示友好信息
# -s：将输出文件的多个空行减少为一个空行
# -p：先清屏再显示
# -c：显示每一屏前都清屏

# 辅助按键：
#   Enter：向下翻一行
#   Space：向下翻一页
#   /字符串：在当前内容查找字符串
#   :f：立刻显示文件名及目前显示的行数
#   q：退出
#   b/ctrl-b：往回翻页，只对文件有用，对管道无效
```

### less

+ 类似 `more`，但更有弹性，即能上下翻页、查找
```sh
less

# 辅助按键：
#   Space：向下翻一页
#   page down：向下翻一页
#   page up：向上翻一页
#   /字符串：向下查找
#   ?字符串：向上查找
#   n：重复前一个查找
#   N：反向重复前一个查找
#   g：前进到数据的第一行
#   G：前进到数据的最后一行
#   q：退出
```

### head

+ 取出文件前几行
```sh
head [-n] <文件名>

# -n：接 行数，表示显示几行

head -n 10 hello.txt  # 显示前 10 行
head -n -10 hello.txt # 显示除最后 10 行外的所有行
```

### tail

+ 取出文件后几行
```sh
tail [-nf] <文件名>

# -n：接 行数，表示显示几行
# -f：持续刷新显示文件的内容，使用 ctrl-c 后退出

tail -n 10 hello.txt        # 显示后 10 行
tail -n +10 hello.txt       # 显示除前 9 行外的所有行
tail -f /var/log/messages   # 持续输出行，直到使用 ctrl-c 退出
```

### od

+ 读取非纯文本文件(二进制文件或数据文件)
```sh
od [-t] <文件名>

# -t：接各种类型，如
#   a      ：利用默认的字符输出
#   c      ：使用 ASCII 字符输出
#   d[size]：使用十进制(decimal)输出数据，每个整数占用 size Bytes
#   o[size]：使用八进制(octal)输出数据，每个整数占用 size Bytes
#   x[size]：使用十六进制(hexadecimal)输出数据，每个整数占用 size Bytes
#   f[size]：使用浮点数(float)输出数据，每个数占用 size Bytes
```



## 查找文件

### which

+ 从 PATH 内设置的目录查找执行文件
```sh
which [-a] <命令名>

# -a：所有由 PATH 中可找到的命令均列出，而不是第一个被找到的命名名

which ifconfig  # 查找成功
which history   # 查找失败，因为 history 是 bash 内置的命令，which 只会查找 PATH 内设置的目录
```

### whereis

+ 从一些特定的目录查找文件
```sh
whereis [-blmsu] <文件名｜目录名>

# -l：列出 whereis 回去查询的几个目录
# -b：只查找二进制(binary)文件
# -m：只查找在说明文件(manual)路径下的文件
# -s：只查找 source 源文件
# -u：查找不再上述三个项目中的其他特殊文件

```

### locate

+ 由已建立的数据库(/var/lib/mlocate)中的数据查找，该数据库通常每天更新一次
```sh
locate [-iclSr] <关键字>

# -i：忽略大小写
# -c：不输出文件名，仅计算找到的文件数量
# -l：接 行数，仅输出几行
# -S：输出 locate 使用的数据库文件的相关信息，包括该数据库记录的文件/目录数量等
# -r：接 震泽表达式的显示方式
```

### undatedb

+ 手动更新 locate 数据库，使 locate 对新文件可用
```sh
undatedb
```

### find

+ 从磁盘查找文件，受磁盘影响速度较慢
```sh
find [查找路径] [-option] [-print -exec -ok 命令 {} \;] 

# -name '字符串'
# -lname '字符串'
# -gid：接 GID
# -uid：接 UID
# -empty：空文件
# -path '字符串'
# -group '字符串'
# -depth
# -prune 目录
# -size n
# -user '字符串'
# -mtime：接修改的天数，n(n 天前那一天修改)、+n(n 天前[不包括那一天]修改)，-n(前 n 天被修改)
# -type：接文件类型
# -print：打印搜索结果
# -exec：对搜索结果执行 Linux 命令
# -ok：询问是否对搜索结果执行 Linux 命令
```




## 文件隐藏属性

### lsattr

+ 显示文件的隐藏属性
```sh
lsattr [-adR] <文件名｜目录名>

# -a：显示隐藏文件的属性
# -d：对于目录，仅显示目录的属性(不显示目录内的文件名)
# -R：显示子目录
```

### chattr

+ 修改文件的隐藏属性(只能在传统的 ext2、ext3、ext4 文件系统上生效，其它文件系统可能无法完整支持)
```sh
chattr [+-=] [ASacdistu] <文件名｜目录名>

# +-=：分别为添加、删除、直接设置属性
# -A：设置后，文件/目录的存取时间(atime)将不会修改(可避免 I/O 较慢的机器过度读写磁盘)
# -S：设置后，文件的修改会同步写入(默认文件是非同步写入的)
# -c：设置后，文件会自动解压缩(写入时加压再存储，读取时自动解压；对大文件似乎比较有用)
# -d：设置后，文件/目录不会被 dump 程序备份
# -a：设置后，文件只能增加数据(不能删除、修改)，仅 root 能设置
# -i：设置后，文件被冻结(不能删除、改名、写入或修改数据，也不能设置链接；对于系统安全性有帮助)，仅 root 能设置
# -s：设置后，文件删除后无法恢复
# -u：设置后，文件删除后还能恢复
```



## diff

+ 比较文件的差异(逐行比较)
+ 若比较的是目录，则比较目录中同名的文件，不会比较子目录
```sh
diff [option] <文件1> <文件2>

# option:
#   -c: 显示全部内容，标出不同之处
#   -b: 忽略行尾的空格，同时将任意多个连续空格视为一个
#   -r: 当文件1 和文件2 为目录时，比较子目录中的文件
#   -s: 当两文件相同时，显示文件的相同信息
```



## grep

+ 过滤文本，显示包含查询字符串的所有行
```sh
grep [option] <查找的字符串> <文件名>

# option:
#   -A: 接 <数值>，除了列出符合条件的行外，同时列出每个符合条件行的后 NUM 行
#   -B: 除了列出符合条件的行外，同时列出每个符合条件行的前 NUM 行
#   -c: 只显示符合条件的行数，不显示每行的具体信息
#   -f: 接 <文件名>,以一个文件(保存了需要搜索的样式)作为条件进行搜索
#   -i: 忽略大小写
#   -n: 在搜索结果中显示行号
```

+ 常用：
```sh
# 通过管道传入数据
cat hello.txt | grep 'hello'

# 查询 nginx 相关进程
ps -ef | grep nginx
```



## split

+ 分割文档
```sh
split [option] [input_file] [output_file]

# option:
#   -b: 接 <size>，指定分割的文件大小，可以指定单位(b, k, m)
#   -n: 指定分割文件的长度，默认 1000 行
#   -d: 将生成的文件序列以数字形式命名
#   -a: 指定生成的文件序列的长度，默认长度为 2
```



## ln

+ 在文件或目录之间创建链接(默认为硬链接)
```sh
ln [option]

# option:
#   -r: 若目标文件位置中存在与链接名相同的文件，则删除这个文件
#   -s: 软链接
#   -d: 允许系统管理员硬链接自己的目录
#   -b: 对将在链接时会被覆盖或者删除的文件进行备份
```

::: tip 硬链接和软链接：
+ 硬链接：通过文件的 `inode` 进行链接，只有当最后一个链接被删除后，文档数据块才会被释放(真正删除)
+ 软链接：也叫符号链接，相当于 `Windows` 的快捷方式
:::

+ 常用：
```sh
# 为 nginx 添加软连接，使命令可以在全局使用
ln -s /usr/local/nginx/sbin/nginx /usr/local/bin/nginx
```