(window.webpackJsonp=window.webpackJsonp||[]).push([[93],{507:function(t,s,a){"use strict";a.r(s);var n=a(25),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"代理多个应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#代理多个应用"}},[t._v("#")]),t._v(" 代理多个应用")]),t._v(" "),a("p",[a("strong",[t._v("原理")]),t._v("：用 "),a("code",[t._v("Nginx")]),t._v(" 代理服务器的 80 端口，服务器内部在 8021/8022 端口启动的程序都会映射在 80 端口下，并且分别为 8021/8022 端口赋予不同的域名，就可以实现部署多个不同功能的应用。")]),t._v(" "),a("ul",[a("li",[t._v("浏览器访问 "),a("code",[t._v("api.domain.com")]),t._v(" 相当于访问服务器内 "),a("code",[t._v("http://127.0.0.1:8021")]),t._v(" 启动的应用")]),t._v(" "),a("li",[t._v("浏览器访问 "),a("code",[t._v("music.domain.com")]),t._v(" 相当于访问服务器内 "),a("code",[t._v("http://127.0.0.1:8022")]),t._v(" 启动的应用")])]),t._v(" "),a("p",[a("strong",[t._v("配置")]),t._v("：")]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[t._v("http "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("  \n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# other setting")]),t._v("\n  server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name api.domain.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_set_header   Host      "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_pass         http://127.0.0.1:8021"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_redirect     off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_set_header   X-Real-IP       "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_set_header   X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  server "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    listen "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    server_name music.domain.com"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    location / "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      proxy_set_header   Host      "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$http_host")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_pass         http://127.0.0.1:8022"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_redirect     off"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_set_header   X-Real-IP       "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$remote_addr")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n      proxy_set_header   X-Forwarded-For "),a("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$proxy_add_x_forwarded_for")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("备注")]),t._v(" "),a("ul",[a("li",[t._v("必须为使用的所有域名都解析到该服务器上(记录类型为 "),a("code",[t._v("A")]),t._v(" 类型，并设置相应的记录值)")]),t._v(" "),a("li",[t._v("使用这种方式，可以绕过备案系统，直接绑定域名和服务器")]),t._v(" "),a("li",[t._v("还可以添加三级域名的解析(但是会降低域名解析的速度)：")])]),t._v(" "),a("div",{staticClass:"language-sh extra-class"},[a("pre",{pre:!0,attrs:{class:"language-sh"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# music 应用")]),t._v("\nmusic.domain.com      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# web 端页面")]),t._v("\nh5.music.domain.com   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 移动端页面")]),t._v("\napi.music.domain.com  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# api 服务")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 商城应用")]),t._v("\nshop.domain.com      "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# web 端页面")]),t._v("\nh5.shop.domain.com   "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 移动端页面")]),t._v("\napi.shop.domain.com  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# api 服务")]),t._v("\n")])])]),a("ul",[a("li",[t._v("使用一个域名和一个服务器就可以搭建很多的小应用，但是应用变大就要拆分了")])])])])}),[],!1,null,null,null);s.default=e.exports}}]);